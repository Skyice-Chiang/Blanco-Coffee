(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d84fc92"],{"133e":function(t,e,a){"use strict";a("b2c7")},"13d5":function(t,e,a){"use strict";var s=a("23e7"),r=a("d58f").left,o=a("a640"),i=a("2d00"),n=a("605d"),c=o("reduce"),l=!n&&i>79&&i<83;s({target:"Array",proto:!0,forced:!c||l},{reduce:function(t){return r(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"2e05":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cart-banner"},[a("div",{staticClass:"pay-step"},[a("div",{staticClass:"step-group d-flex justify-content-between align-items-center"},[a("div",{staticClass:"step-circle",class:{active:"1"==t.step}},[t._v("1")]),a("div",{staticClass:"step-circle",class:{active:"2"==t.step}},[t._v("2")]),a("div",{staticClass:"step-circle",class:{active:"3"==t.step}},[t._v("3")])])]),a("div",{staticClass:"cart-title"},[a("div",[t._v(t._s(t.title))])])])},r=[],o={props:["step","title"]},i=o,n=(a("76da"),a("2877")),c=Object(n["a"])(i,s,r,!1,null,"59cc66a6",null);e["a"]=c.exports},"76da":function(t,e,a){"use strict";a("8bb5")},8418:function(t,e,a){"use strict";var s=a("c04e"),r=a("9bf2"),o=a("5c6c");t.exports=function(t,e,a){var i=s(e);i in t?r.f(t,i,o(0,a)):t[i]=a}},"8bb5":function(t,e,a){},"99af":function(t,e,a){"use strict";var s=a("23e7"),r=a("d039"),o=a("e8b5"),i=a("861d"),n=a("7b0b"),c=a("50c4"),l=a("8418"),d=a("65f0"),u=a("1dde"),p=a("b622"),f=a("2d00"),v=p("isConcatSpreadable"),m=9007199254740991,g="Maximum allowed index exceeded",h=f>=51||!r((function(){var t=[];return t[v]=!1,t.concat()[0]!==t})),b=u("concat"),_=function(t){if(!i(t))return!1;var e=t[v];return void 0!==e?!!e:o(t)},C=!h||!b;s({target:"Array",proto:!0,forced:C},{concat:function(t){var e,a,s,r,o,i=n(this),u=d(i,0),p=0;for(e=-1,s=arguments.length;e<s;e++)if(o=-1===e?i:arguments[e],_(o)){if(r=c(o.length),p+r>m)throw TypeError(g);for(a=0;a<r;a++,p++)a in o&&l(u,p,o[a])}else{if(p>=m)throw TypeError(g);l(u,p++,o)}return u.length=p,u}})},b2c7:function(t,e,a){},c489:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bg-primary"},[a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),a("OrderProgress",{attrs:{step:2,title:"Order"}}),a("div",{staticClass:"container d-block d-lg-flex justify-content-center py-5"},[a("div",{staticClass:"mb-5 mr-lg-4"},[a("div",{staticClass:"border-style table-responsive"},[a("table",{staticClass:"table table-hover table-dark table-borderless bg-transparent mb-0"},[t._m(0),a("tbody",[t._l(t.products,(function(e,s){return a("tr",{key:s},[a("td",[t._v(t._s(e.product.title))]),a("td",[t._v("x "+t._s(e.qty))]),a("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(e.total)))])])})),a("tr",{staticClass:"border-top"},[a("td",{attrs:{colspan:"2"}}),a("td",{staticClass:"text-right"},[a("div",{class:{"text-delete":t.isCoupon}},[t._v(" 總額 "+t._s(t._f("currency")(t.total))+" ")]),t.isCoupon?a("div",{staticClass:"text-right text-c-green"},[t._v(" 優惠價 "+t._s(t._f("currency")(t.finalTotal))+" ")]):t._e()])])],2)])]),a("div",{staticClass:"input-group w-100 mt-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"form-control bg-transparent text-white border-secondary",attrs:{type:"text",placeholder:"請輸入優惠碼"},domProps:{value:t.code},on:{input:function(e){e.target.composing||(t.code=e.target.value)}}}),a("div",{staticClass:"input-group-append"},[a("div",{staticClass:"btn btn-outline-secondary",on:{click:t.addCoupon}},[t._v(" 套用優惠券 ")])])]),t.isError?a("small",{staticClass:"text-danger"},[t._v(t._s(t.couponMessage))]):t._e()]),a("div",[a("div",{staticClass:"border-style p-3"},[a("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var s=e.invalid;return[a("form",{staticClass:"needs-validation",attrs:{novalidate:""}},[a("div",{staticClass:"form-row"},[a("ValidationProvider",{staticClass:"col-md-6",attrs:{name:"姓名",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors;return[a("div",{staticClass:"form-group"},[a("label",{staticClass:"text-white",attrs:{for:"name"}},[t._v("姓名")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"}],staticClass:"form-control bg-transparent",class:{"is-invalid":s[0]},attrs:{type:"text",id:"name",placeholder:"請輸入姓名"},domProps:{value:t.form.user.name},on:{input:function(e){e.target.composing||t.$set(t.form.user,"name",e.target.value)}}}),a("span",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))])])]}}],null,!0)}),a("ValidationProvider",{staticClass:"col-md-6",attrs:{name:"電話",rules:"required|tel"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors;return[a("div",{staticClass:"form-group"},[a("label",{staticClass:"text-white",attrs:{for:"tel"}},[t._v("電話")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"}],staticClass:"form-control bg-transparent",class:{"is-invalid":s[0]},attrs:{type:"number",id:"tel",placeholder:"請輸入電話",inputmode:"tel"},domProps:{value:t.form.user.tel},on:{input:function(e){e.target.composing||t.$set(t.form.user,"tel",e.target.value)}}}),a("span",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))])])]}}],null,!0)})],1),a("ValidationProvider",{attrs:{name:"信箱",rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors;return[a("div",{staticClass:"form-group"},[a("label",{staticClass:"text-white",attrs:{for:"useremail"}},[t._v("信箱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"}],staticClass:"form-control bg-transparent",class:{"is-invalid":s[0]},attrs:{type:"text",name:"email",id:"useremail",placeholder:"請輸入信箱",inputmode:"email"},domProps:{value:t.form.user.email},on:{input:function(e){e.target.composing||t.$set(t.form.user,"email",e.target.value)}}}),a("span",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))])])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"地址",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors;return[a("div",{staticClass:"form-group"},[a("label",{staticClass:"text-white",attrs:{for:"address"}},[t._v("地址")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"}],staticClass:"form-control bg-transparent",class:{"is-invalid":s[0]},attrs:{type:"text",id:"address",placeholder:"請輸入地址"},domProps:{value:t.form.user.address},on:{input:function(e){e.target.composing||t.$set(t.form.user,"address",e.target.value)}}}),s[0]?a("span",{staticClass:"invalid-feedback"},[t._v(t._s(s[0]))]):t._e()])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"付款",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.errors;return[a("div",{staticClass:"form-group"},[a("label",{staticClass:"text-white",attrs:{for:"pay"}},[t._v("付款方式")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.form.user.pay,expression:"form.user.pay"}],staticClass:"custom-select",class:{"is-invalid":s[0]},attrs:{id:"pay"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.form.user,"pay",e.target.multiple?a:a[0])}}},[a("option",{attrs:{selected:"",disabled:"",value:""}},[t._v("--選擇一種付款方式--")]),a("option",{attrs:{value:"Credit"}},[t._v("Credit")]),a("option",{attrs:{value:"ATM"}},[t._v("ATM")]),a("option",{attrs:{value:"ApplePay"}},[t._v("ApplePay")]),a("option",{attrs:{value:"LinePay"}},[t._v("LinePay")]),a("option",{attrs:{value:"WebATM"}},[t._v("WebATM")])]),s[0]?a("span",{staticClass:"invalid-feedback"},[t._v("請選擇一種付款方式")]):t._e()])]}}],null,!0)}),a("div",{staticClass:"form-group"},[a("label",{staticClass:"text-white",attrs:{for:"message"}},[t._v("備註")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{name:"message",id:"message",cols:"30",rows:"10",placeholder:"有什麼想跟我們說"},domProps:{value:t.form.message},on:{input:function(e){e.target.composing||t.$set(t.form,"message",e.target.value)}}})]),a("div",{staticClass:"text-right"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"submit",disabled:s},on:{click:function(e){return e.preventDefault(),t.addOrder(e)}}},[t._v(" 送出訂單 ")])])],1)]}}])})],1)])])],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",{staticClass:"text-c-brown"},[a("th",[t._v("項目")]),a("th",{attrs:{width:"80"}},[t._v("數量")]),a("th",{attrs:{width:"100"}},[t._v("金額")])])])}],o=(a("d81d"),a("13d5"),a("99af"),a("159b"),a("2e05")),i={data:function(){return{products:[],form:{user:{name:"",email:"",tel:"",address:"",pay:""},message:""},isLoading:!1,code:"",isCoupon:!1,isError:!1,couponMessage:"",finalTotal:0}},components:{OrderProgress:o["a"]},computed:{total:function(){var t=this.products.map((function(t){return t.total}));return t.reduce((function(t,e){return t+e}),0)}},methods:{getProducts:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("blanco_coffee","/cart");t.isLoading=!0,t.$http.get(e).then((function(e){e.data.success&&(t.products=e.data.data.carts,t.$bus.$emit("navActive",""),t.$bus.$emit("changeNum",0),localStorage.setItem("carts","[]"),t.isLoading=!1)}))},addCoupon:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("blanco_coffee","/coupon"),a=t.code;t.$http.post(e,{data:{code:a}}).then((function(e){e.data.success?(t.isCoupon=!0,t.finalTotal=Math.ceil(e.data.data.final_total),t.code="",t.$bus.$emit("message:push","成功套用優惠券","success","fa-check-circle"),t.isError=!1):(t.isError=!0,t.couponMessage=e.data.message)}))},addOrder:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("blanco_coffee","/order");t.isLoading=!0,t.$http.post(e,{data:t.form}).then((function(e){e.data.success?(t.isLoading=!1,t.$bus.$emit("message:push","訂單成立","success","fa-check-circle"),t.$router.push("/Customercheckout/".concat(e.data.orderId)),window.scroll(0,0)):t.$bus.$emit("message:push",e.data.message,"danger","fa-times-circle")}))},deletList:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("blanco_coffee","/cart"),a=[];t.$http.get(e).then((function(e){e.data.success&&(a=e.data.data.carts.map((function(t){return t.id})),a.forEach((function(e){var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("blanco_coffee","/cart/").concat(e);t.$http.delete(a)})))}))}},created:function(){this.getProducts()},beforeDestroy:function(){this.deletList()}},n=i,c=(a("133e"),a("2877")),l=Object(c["a"])(n,s,r,!1,null,"536b9ab4",null);e["default"]=l.exports},d58f:function(t,e,a){var s=a("1c0b"),r=a("7b0b"),o=a("44ad"),i=a("50c4"),n=function(t){return function(e,a,n,c){s(a);var l=r(e),d=o(l),u=i(l.length),p=t?u-1:0,f=t?-1:1;if(n<2)while(1){if(p in d){c=d[p],p+=f;break}if(p+=f,t?p<0:u<=p)throw TypeError("Reduce of empty array with no initial value")}for(;t?p>=0:u>p;p+=f)p in d&&(c=a(c,d[p],p,l));return c}};t.exports={left:n(!1),right:n(!0)}},d81d:function(t,e,a){"use strict";var s=a("23e7"),r=a("b727").map,o=a("1dde"),i=o("map");s({target:"Array",proto:!0,forced:!i},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-4d84fc92.a062cde8.js.map